<!DOCTYPE html>
<html lang="si" data-theme="dark">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Fairyscript - à·ƒà·’à¶‚à·„à¶½ à·ƒà¶¶à·Šà¶§à¶ºà·’à¶§à¶½à·Šà·ƒà·Š</title>
  <meta name="description" content="Download and upload Sinhala subtitles for movies, dramas and anime." />

  <!-- Google Fonts: Noto Sans Sinhala for proper Sinhala rendering -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />

  <!-- Firebase v8 compat -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>

  <link rel="stylesheet" href="styles.css" />
</head>
<body>

<!-- ========== ANIMATED BACKGROUND ========== -->
<div class="bg-orbs">
  <div class="orb orb1"></div>
  <div class="orb orb2"></div>
  <div class="orb orb3"></div>
</div>

<!-- ========== TOAST NOTIFICATIONS ========== -->
<div id="toast-container"></div>

<!-- ========== NAVBAR ========== -->
<nav class="navbar">
  <div class="nav-brand">
    <div class="nav-logo">
      <img src="logo.jpg" alt="Fairyscript Logo" onerror="this.style.display='none';this.nextElementSibling.style.display='flex'" />
      <span class="logo-fallback">âœ¨</span>
    </div>
    <span class="nav-title">fairyscript</span>
    <span class="nav-badge">BETA</span>
  </div>

  <div class="nav-center" id="nav-search-wrap">
    <div class="search-bar">
      <svg class="search-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
      <input type="text" id="search-input" placeholder="à·ƒà¶¶à·Šà¶§à¶ºà·’à¶§à¶½à·Š à·„à·œà¶ºà¶±à·Šà¶±..." autocomplete="off" />
      <button class="search-clear" id="search-clear" style="display:none">âœ•</button>
    </div>
  </div>

  <div class="nav-actions">
    <button class="btn-icon" id="theme-toggle" title="Dark/Light Mode">
      <svg class="icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/></svg>
      <svg class="icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display:none"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
    </button>

    <!-- Logged-out state -->
    <button class="btn-primary" id="nav-login-btn">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/><polyline points="10 17 15 12 10 7"/><line x1="15" y1="12" x2="3" y2="12"/></svg>
      Login
    </button>

    <!-- Logged-in state (hidden by default) -->
    <button class="btn-upload" id="nav-upload-btn" style="display:none">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
      Upload
    </button>

    <div class="user-menu" id="user-menu" style="display:none">
      <img id="user-avatar" src="" alt="User" class="user-avatar" />
      <div class="user-dropdown" id="user-dropdown">
        <div class="user-info">
          <span id="dropdown-name"></span>
          <span id="dropdown-email"></span>
        </div>
        <hr />
        <button id="my-uploads-btn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
          à¶¸à¶œà·š Uploads
        </button>
        <button id="logout-btn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" y1="12" x2="9" y2="12"/></svg>
          Logout
        </button>
      </div>
    </div>
  </div>
</nav>

<!-- ========== HERO (pre-login) ========== -->
<section class="hero" id="hero-section">
  <div class="hero-content">
    <div class="hero-badge">ğŸ¬ Sinhala Subtitle Community</div>
    <h1 class="hero-title">
      à¶•à¶±à¶¸ à·†à·’à¶½à·Šà¶¸à·Š à¶‘à¶šà¶§<br/>
      <span class="gradient-text">à·ƒà·’à¶‚à·„à¶½ à·ƒà¶¶à·Šà¶§à¶ºà·’à¶§à¶½à·Š</span>
    </h1>
    <p class="hero-sub">
      à¶½à·œà·€ à¶•à¶±à·‘à¶¸ à¶»à¶§à·š à·†à·’à¶½à·Šà¶¸à·Š, à¶©à·Šâ€à¶»à·à¶¸à·, à¶‡à¶±à·’à¶¸à·š à·ƒà¶³à·„à·<br/>
      à·ƒà·’à¶‚à·„à¶½ à·ƒà¶¶à·Šà¶§à¶ºà·’à¶§à¶½à·Š download à¶šà¶»à¶±à·Šà¶± à·ƒà·„ upload à¶šà¶»à¶±à·Šà¶±
    </p>
    <div class="hero-actions">
      <button class="btn-hero-primary" id="hero-login-btn">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h4m7-4l5-5-5-5m5 5H9"/></svg>
        GitHub à·„à¶»à·„à· Login
      </button>
      <button class="btn-hero-secondary" id="hero-browse-btn">
        Browse Subtitles â†“
      </button>
    </div>
    <div class="hero-stats">
      <div class="stat-pill"><span id="total-count">0</span> Subtitles</div>
      <div class="stat-pill">UTF-8 Encoded</div>
      <div class="stat-pill">Free Forever</div>
    </div>
  </div>
  <div class="hero-visual">
    <div class="floating-card fc1">
      <span>ğŸ‡°ğŸ‡·</span> Korean Drama
    </div>
    <div class="floating-card fc2">
      <span>ğŸ‡¯ğŸ‡µ</span> Anime
    </div>
    <div class="floating-card fc3">
      <span>ğŸ‡ºğŸ‡¸</span> Hollywood
    </div>
    <div class="floating-card fc4">
      <span>ğŸŒ</span> Asian Films
    </div>
  </div>
</section>

<!-- ========== FILTER BAR ========== -->
<div class="filter-section" id="filter-section">
  <div class="filter-wrap">
    <div class="filter-scroll">
      <select id="filter-country" class="filter-select">
        <option value="">ğŸŒ All Countries</option>
        <option value="Korea">ğŸ‡°ğŸ‡· Korea</option>
        <option value="Japan">ğŸ‡¯ğŸ‡µ Japan</option>
        <option value="China">ğŸ‡¨ğŸ‡³ China</option>
        <option value="Thailand">ğŸ‡¹ğŸ‡­ Thailand</option>
        <option value="USA">ğŸ‡ºğŸ‡¸ USA</option>
        <option value="UK">ğŸ‡¬ğŸ‡§ UK</option>
        <option value="India">ğŸ‡®ğŸ‡³ India</option>
      </select>

      <select id="filter-year" class="filter-select">
        <option value="">ğŸ“… All Years</option>
        <option value="2026">2026</option>
        <option value="2025">2025</option>
        <option value="2024">2024</option>
        <option value="2023">2023</option>
        <option value="2022">2022</option>
        <option value="2021">2021</option>
        <option value="2020">2020</option>
      </select>

      <select id="filter-genre" class="filter-select">
        <option value="">ğŸ­ All Genres</option>
        <option value="Action">âš”ï¸ Action</option>
        <option value="Romance">ğŸ’• Romance</option>
        <option value="Comedy">ğŸ˜‚ Comedy</option>
        <option value="Thriller">ğŸ˜± Thriller</option>
        <option value="Drama">ğŸ­ Drama</option>
        <option value="Fantasy">ğŸ§™ Fantasy</option>
        <option value="Sci-Fi">ğŸš€ Sci-Fi</option>
        <option value="Horror">ğŸ‘» Horror</option>
        <option value="Anime">ğŸœ Anime</option>
      </select>

      <select id="filter-sort" class="filter-select">
        <option value="newest">ğŸ• Newest First</option>
        <option value="oldest">ğŸ“… Oldest First</option>
        <option value="downloads">ğŸ”¥ Most Downloaded</option>
        <option value="az">ğŸ”¤ A-Z</option>
      </select>

      <button class="filter-clear" id="filter-clear-btn">âœ• Clear</button>
    </div>
    <div class="results-count" id="results-count"></div>
  </div>
</div>

<!-- ========== SUBTITLE GRID ========== -->
<main class="main-content" id="main-content">
  <div class="subtitle-grid" id="subtitle-grid">
    <!-- Cards rendered by JS -->
  </div>
  <div class="loading-state" id="loading-state">
    <div class="loader-ring"></div>
    <p>Loading subtitles...</p>
  </div>
  <div class="empty-state" id="empty-state" style="display:none">
    <div class="empty-icon">ğŸ”</div>
    <h3>à·ƒà¶¶à·Šà¶§à¶ºà·’à¶§à¶½à·Š à·„à¶¸à·Šà¶¶ à·€à·”à¶±à·š à¶±à·‘</h3>
    <p>Try different search terms or filters</p>
  </div>
</main>

<!-- ========== FAB (upload) - shown when logged in ========== -->
<button class="fab" id="fab-upload" style="display:none" title="Upload Subtitle">
  <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
</button>

<!-- ========== FOOTER ========== -->
<footer class="footer">
  <div class="footer-inner">
    <div class="footer-brand">
      <span class="gradient-text">fairyscript</span>
      <span class="footer-tagline">à·ƒà·’à¶‚à·„à¶½ à¶‹à¶´à·ƒà·’à¶»à·à·ƒà·’ à¶´à·Šâ€à¶»à¶¢à·à·€</span>
    </div>
    <div class="footer-links">
      <a href="#">About</a>
      <a href="#">Privacy</a>
      <a href="https://github.com/bigunbimsara/Fairyscript_-_subtitles" target="_blank">GitHub</a>
    </div>
    <p class="footer-copy">Â© 2026 Fairyscript Â· MIT License</p>
  </div>
</footer>

<!-- ========== LOGIN MODAL ========== -->
<div class="modal-overlay" id="login-modal">
  <div class="modal glass-modal">
    <button class="modal-close" data-close="login-modal">âœ•</button>
    <div class="modal-header">
      <div class="modal-logo">âœ¨</div>
      <h2>Fairyscript à·€à¶½à¶§ Login</h2>
      <p>Subtitles upload à¶šà¶»à¶±à·Šà¶± à·ƒà·„ manage à¶šà¶»à¶±à·Šà¶±</p>
    </div>
    <button class="btn-github-login" id="github-login-btn">
      <svg viewBox="0 0 24 24" fill="currentColor" width="22" height="22"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
      Continue with GitHub
    </button>
    <p class="modal-note">GitHub account à¶‘à¶šà·™à¶±à·Š safely login à¶šà¶»à¶±à·Šà¶±</p>
  </div>
</div>

<!-- ========== UPLOAD MODAL ========== -->
<div class="modal-overlay" id="upload-modal">
  <div class="modal glass-modal upload-modal-inner">
    <button class="modal-close" data-close="upload-modal">âœ•</button>
    <div class="modal-header">
      <h2>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="24" height="24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
        Subtitle Upload à¶šà¶»à¶±à·Šà¶±
      </h2>
    </div>

    <form id="upload-form" novalidate>
      <!-- Row 1: Title -->
      <div class="form-group">
        <label>Title <span class="req">*</span></label>
        <input type="text" id="up-title" placeholder="à¶‹à¶¯à·: Squid Game - Season 2" required />
      </div>

      <!-- Row 2: Description -->
      <div class="form-group">
        <label>Description</label>
        <textarea id="up-desc" placeholder="Subtitle à¶œà·à¶± à¶šà·™à¶§à·’ à·€à·’à·ƒà·Šà¶­à¶»à¶ºà¶šà·Š..." rows="2"></textarea>
      </div>

      <!-- Row 3: Subtitle file -->
      <div class="form-group">
        <label>Subtitle File <span class="req">*</span></label>
        <div class="file-drop-zone" id="subtitle-drop">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="40" height="40"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
          <p>Drag & drop à·„à· click à¶šà¶»à¶±à·Šà¶±</p>
          <span class="file-types">.srt Â· .ass Â· .ssa Â· .sub Â· .vtt (Max 5MB)</span>
          <input type="file" id="up-subtitle" accept=".srt,.ass,.ssa,.sub,.vtt" required />
        </div>
        <div class="file-selected" id="subtitle-selected" style="display:none">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18"><path d="M9 12l2 2 4-4m6 2a9 9 0 1 1-18 0 9 9 0 0 1 18 0z"/></svg>
          <span id="subtitle-filename"></span>
          <button type="button" class="remove-file" id="remove-subtitle">âœ•</button>
        </div>
      </div>

      <!-- Row 4: Video format -->
      <div class="form-group">
        <label>Video Format / Resolution</label>
        <div class="format-grid">
          <label class="format-chip">
            <input type="radio" name="video-format" value="1080p H.264" />
            <span>1080p H.264</span>
          </label>
          <label class="format-chip">
            <input type="radio" name="video-format" value="1080p H.265/HEVC" />
            <span>1080p H.265</span>
          </label>
          <label class="format-chip">
            <input type="radio" name="video-format" value="720p H.264" />
            <span>720p H.264</span>
          </label>
          <label class="format-chip">
            <input type="radio" name="video-format" value="720p H.265/HEVC" />
            <span>720p H.265</span>
          </label>
          <label class="format-chip">
            <input type="radio" name="video-format" value="480p" />
            <span>480p SD</span>
          </label>
          <label class="format-chip">
            <input type="radio" name="video-format" value="4K UHD H.265" />
            <span>4K UHD</span>
          </label>
          <label class="format-chip">
            <input type="radio" name="video-format" value="All" checked />
            <span>All Formats</span>
          </label>
        </div>
      </div>

      <!-- Row 5: Meta selects -->
      <div class="form-row-3">
        <div class="form-group">
          <label>Country</label>
          <select id="up-country">
            <option value="">Select</option>
            <option value="Korea">ğŸ‡°ğŸ‡· Korea</option>
            <option value="Japan">ğŸ‡¯ğŸ‡µ Japan</option>
            <option value="China">ğŸ‡¨ğŸ‡³ China</option>
            <option value="Thailand">ğŸ‡¹ğŸ‡­ Thailand</option>
            <option value="USA">ğŸ‡ºğŸ‡¸ USA</option>
            <option value="UK">ğŸ‡¬ğŸ‡§ UK</option>
            <option value="India">ğŸ‡®ğŸ‡³ India</option>
          </select>
        </div>
        <div class="form-group">
          <label>Year</label>
          <select id="up-year">
            <option value="">Select</option>
            <option value="2026">2026</option>
            <option value="2025">2025</option>
            <option value="2024">2024</option>
            <option value="2023">2023</option>
            <option value="2022">2022</option>
            <option value="2021">2021</option>
            <option value="2020">2020</option>
          </select>
        </div>
        <div class="form-group">
          <label>Genre</label>
          <select id="up-genre">
            <option value="">Select</option>
            <option value="Action">âš”ï¸ Action</option>
            <option value="Romance">ğŸ’• Romance</option>
            <option value="Comedy">ğŸ˜‚ Comedy</option>
            <option value="Thriller">ğŸ˜± Thriller</option>
            <option value="Drama">ğŸ­ Drama</option>
            <option value="Fantasy">ğŸ§™ Fantasy</option>
            <option value="Sci-Fi">ğŸš€ Sci-Fi</option>
            <option value="Horror">ğŸ‘» Horror</option>
            <option value="Anime">ğŸœ Anime</option>
          </select>
        </div>
      </div>

      <!-- Row 6: Cover image -->
      <div class="form-group">
        <label>Cover Image (Optional)</label>
        <div class="image-upload-wrap">
          <div class="file-drop-zone img-drop" id="image-drop">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" width="30" height="30"><rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
            <p>Image Upload</p>
            <span class="file-types">.jpg Â· .png Â· .webp (Max 2MB)</span>
            <input type="file" id="up-image" accept="image/*" />
          </div>
          <div class="image-preview-wrap" id="image-preview-wrap" style="display:none">
            <img id="image-preview-thumb" src="" alt="Preview" />
            <button type="button" class="remove-file img-remove" id="remove-image">âœ•</button>
          </div>
        </div>
      </div>

      <!-- Submit -->
      <div class="form-actions">
        <button type="submit" class="btn-submit" id="submit-btn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
          Upload Subtitle
        </button>
      </div>

      <!-- Progress -->
      <div class="upload-progress" id="upload-progress" style="display:none">
        <div class="progress-bar">
          <div class="progress-fill" id="progress-fill"></div>
        </div>
        <span id="progress-text">Uploading... 0%</span>
      </div>
    </form>
  </div>
</div>

<!-- ========== SUBTITLE DETAIL MODAL ========== -->
<div class="modal-overlay" id="detail-modal">
  <div class="modal glass-modal detail-modal-inner">
    <button class="modal-close" data-close="detail-modal">âœ•</button>
    <div id="detail-content"></div>
  </div>
</div>

<script src="firebase-config.js"></script>
<script src="app.js"></script>
</body>
</html>
